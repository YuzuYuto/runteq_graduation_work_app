<% content_for(:title, '投稿一覧') %>

<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>投稿一覧</h1>
    <%= link_to '新規投稿', new_post_path, class: 'btn btn-primary' %>
  </div>
  
  <% if @posts.any? %>
    <% @posts.each do |post| %>
      <div class="card mb-4 shadow-sm">
        <div class="card-body">
          <div class="border-bottom pb-2 mb-3">
            <h5 class="card-title mb-1 fw-bold text-primary">
              <%= link_to post.title, post_path(post), class: 'text-decoration-none text-primary' %>
            </h5>
            <small class="text-muted">
              <i class="bi bi-person-circle"></i> <%= post.user.email %>
              <span class="mx-2">・</span>
              <i class="bi bi-calendar3"></i> <%= post.created_at.strftime('%Y/%m/%d') %>
            </small>
          </div>
          <div class="mb-3">
            <p class="card-text text-dark mb-0" style="line-height: 1.6;">
              <%= truncate(post.body, length: 100) %>
            </p>
          </div>
        </div>

        <% if post.user == current_user %>
          <div class="ms-3">
            <%= link_to '編集', edit_post_path(post), class: 'btn btn-outline-primary btn-sm mb-1'  %>
            <%= link_to '削除', post_path(post),
                data: {
                  "turbo-method": :delete,
                  "turbo-confirm": "本当に削除しますか?"
                },
                class: 'btn btn-outline-danger btn-sm mb-1' %>
          </div>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <div class="text-center">
      <p>まだ投稿がありません</p>
      <%= link_to '最初の投稿を作成', new_post_path, class: 'btn btn-primary' %>
    </div>
  <% end %>
</div>